"use strict";(()=>{var e={};e.id=871,e.ids=[871],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6686:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>k,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c});var s={};r.r(s),r.d(s,{POST:()=>u});var a=r(9303),o=r(8716),n=r(670),i=r(7070),p=r(5662);async function u(e,{params:t}){try{let{data:e,error:r}=await p.O.from("tasks").select("user_id").eq("id",t.id).single();if(r||!e)return i.NextResponse.json({error:"Task not found"},{status:404});let{data:s,error:a}=await p.O.from("tasks").update({status:"completed",updated_at:new Date().toISOString()}).eq("id",t.id).select().single();if(a)return i.NextResponse.json({error:a.message},{status:500});let{data:o,error:n}=await p.O.from("profiles").select("xp, coins, level").eq("id",e.user_id).single();if(!n&&o){let t=o.xp+10,r=Math.floor(t/100)+1,a=r>o.level;return await p.O.from("profiles").update({xp:t,coins:o.coins+5,last_active_at:new Date().toISOString()}).eq("id",e.user_id),i.NextResponse.json({task:s,rewards:{xp_earned:10,coins_earned:5,level_up:a,new_level:r}})}return i.NextResponse.json({task:s,rewards:{xp_earned:10,coins_earned:5}})}catch(e){return i.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tasks/[id]/complete/route",pathname:"/api/tasks/[id]/complete",filename:"route",bundlePath:"app/api/tasks/[id]/complete/route"},resolvedPagePath:"D:\\vibecode\\tasktask\\app\\api\\tasks\\[id]\\complete\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:m}=d,x="/api/tasks/[id]/complete/route";function k(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},5662:(e,t,r)=>{r.d(t,{N:()=>o,O:()=>a});var s=r(7857);let a=(0,s.eI)("https://your-project.supabase.co","your-anon-key"),o=()=>(0,s.eI)("https://your-project.supabase.co","your-anon-key")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,564],()=>r(6686));module.exports=s})();